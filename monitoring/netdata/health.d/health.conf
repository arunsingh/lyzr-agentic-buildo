# Netdata Health Configuration for AOB Platform

# This configuration defines health checks and alerts for the AOB platform
# covering all core infrastructure, applications, and components

# Global health settings
[global]
    # Health check settings
    enabled = yes
    update every = 1
    
    # Alert settings
    send email = no
    send slack = no
    send discord = no
    send telegram = no
    send webhook = no
    
    # Log settings
    log alerts = yes
    log alerts file = /var/log/netdata/alerts.log
    
    # Retry settings
    retry delay = 60
    max retries = 3

# System health checks
[system]
    # CPU usage
    cpu:
        enabled = yes
        update every = 1
        warn threshold = 80
        crit threshold = 95
        
    # Memory usage
    memory:
        enabled = yes
        update every = 1
        warn threshold = 80
        crit threshold = 95
        
    # Disk usage
    disk:
        enabled = yes
        update every = 1
        warn threshold = 80
        crit threshold = 95
        
    # Load average
    load:
        enabled = yes
        update every = 1
        warn threshold = 2
        crit threshold = 5

# Network health checks
[network]
    # Network interfaces
    interfaces:
        enabled = yes
        update every = 1
        warn threshold = 80
        crit threshold = 95
        
    # Network connections
    connections:
        enabled = yes
        update every = 1
        warn threshold = 1000
        crit threshold = 5000

# Docker health checks
[docker]
    # Docker containers
    containers:
        enabled = yes
        update every = 1
        warn threshold = 80
        crit threshold = 95
        
    # Docker images
    images:
        enabled = yes
        update every = 1
        warn threshold = 80
        crit threshold = 95

# PostgreSQL health checks
[postgres]
    # PostgreSQL connections
    connections:
        enabled = yes
        update every = 1
        warn threshold = 80
        crit threshold = 95
        
    # PostgreSQL queries
    queries:
        enabled = yes
        update every = 1
        warn threshold = 100
        crit threshold = 500
        
    # PostgreSQL locks
    locks:
        enabled = yes
        update every = 1
        warn threshold = 10
        crit threshold = 50

# Redis health checks
[redis]
    # Redis connections
    connections:
        enabled = yes
        update every = 1
        warn threshold = 80
        crit threshold = 95
        
    # Redis memory
    memory:
        enabled = yes
        update every = 1
        warn threshold = 80
        crit threshold = 95
        
    # Redis operations
    operations:
        enabled = yes
        update every = 1
        warn threshold = 1000
        crit threshold = 5000

# Kafka health checks
[kafka]
    # Kafka brokers
    brokers:
        enabled = yes
        update every = 1
        warn threshold = 80
        crit threshold = 95
        
    # Kafka topics
    topics:
        enabled = yes
        update every = 1
        warn threshold = 80
        crit threshold = 95
        
    # Kafka consumers
    consumers:
        enabled = yes
        update every = 1
        warn threshold = 80
        crit threshold = 95

# AOB API health checks
[aob-api]
    # API response time
    response_time:
        enabled = yes
        update every = 1
        warn threshold = 1000
        crit threshold = 5000
        
    # API error rate
    error_rate:
        enabled = yes
        update every = 1
        warn threshold = 5
        crit threshold = 10
        
    # API requests per second
    requests_per_second:
        enabled = yes
        update every = 1
        warn threshold = 100
        crit threshold = 500

# AOB Worker health checks
[aob-worker]
    # Worker queue length
    queue_length:
        enabled = yes
        update every = 1
        warn threshold = 100
        crit threshold = 500
        
    # Worker processing time
    processing_time:
        enabled = yes
        update every = 1
        warn threshold = 1000
        crit threshold = 5000
        
    # Worker error rate
    error_rate:
        enabled = yes
        update every = 1
        warn threshold = 5
        crit threshold = 10

# AOB Audit Service health checks
[aob-audit]
    # Audit service response time
    response_time:
        enabled = yes
        update every = 1
        warn threshold = 1000
        crit threshold = 5000
        
    # Audit service error rate
    error_rate:
        enabled = yes
        update every = 1
        warn threshold = 5
        crit threshold = 10
        
    # Audit service throughput
    throughput:
        enabled = yes
        update every = 1
        warn threshold = 100
        crit threshold = 500

# AOB Model Gateway health checks
[aob-model-gateway]
    # Model gateway response time
    response_time:
        enabled = yes
        update every = 1
        warn threshold = 1000
        crit threshold = 5000
        
    # Model gateway error rate
    error_rate:
        enabled = yes
        update every = 1
        warn threshold = 5
        crit threshold = 10
        
    # Model gateway throughput
    throughput:
        enabled = yes
        update every = 1
        warn threshold = 100
        crit threshold = 500

# AOB Tool Gateway health checks
[aob-tool-gateway]
    # Tool gateway response time
    response_time:
        enabled = yes
        update every = 1
        warn threshold = 1000
        crit threshold = 5000
        
    # Tool gateway error rate
    error_rate:
        enabled = yes
        update every = 1
        warn threshold = 5
        crit threshold = 10
        
    # Tool gateway throughput
    throughput:
        enabled = yes
        update every = 1
        warn threshold = 100
        crit threshold = 500

# AOB Tenant Manager health checks
[aob-tenant-manager]
    # Tenant manager response time
    response_time:
        enabled = yes
        update every = 1
        warn threshold = 1000
        crit threshold = 5000
        
    # Tenant manager error rate
    error_rate:
        enabled = yes
        update every = 1
        warn threshold = 5
        crit threshold = 10
        
    # Tenant manager throughput
    throughput:
        enabled = yes
        update every = 1
        warn threshold = 100
        crit threshold = 500

# AOB Session Service health checks
[aob-session-service]
    # Session service response time
    response_time:
        enabled = yes
        update every = 1
        warn threshold = 1000
        crit threshold = 5000
        
    # Session service error rate
    error_rate:
        enabled = yes
        update every = 1
        warn threshold = 5
        crit threshold = 10
        
    # Session service throughput
    throughput:
        enabled = yes
        update every = 1
        warn threshold = 100
        crit threshold = 500

# AOB Metering Service health checks
[aob-metering-service]
    # Metering service response time
    response_time:
        enabled = yes
        update every = 1
        warn threshold = 1000
        crit threshold = 5000
        
    # Metering service error rate
    error_rate:
        enabled = yes
        update every = 1
        warn threshold = 5
        crit threshold = 10
        
    # Metering service throughput
    throughput:
        enabled = yes
        update every = 1
        warn threshold = 100
        crit threshold = 500

# AOB Execution Service health checks
[aob-execution-service]
    # Execution service response time
    response_time:
        enabled = yes
        update every = 1
        warn threshold = 1000
        crit threshold = 5000
        
    # Execution service error rate
    error_rate:
        enabled = yes
        update every = 1
        warn threshold = 5
        crit threshold = 10
        
    # Execution service throughput
    throughput:
        enabled = yes
        update every = 1
        warn threshold = 100
        crit threshold = 500

# AOB Agent Registry health checks
[aob-agent-registry]
    # Agent registry response time
    response_time:
        enabled = yes
        update every = 1
        warn threshold = 1000
        crit threshold = 5000
        
    # Agent registry error rate
    error_rate:
        enabled = yes
        update every = 1
        warn threshold = 5
        crit threshold = 10
        
    # Agent registry throughput
    throughput:
        enabled = yes
        update every = 1
        warn threshold = 100
        crit threshold = 500

# Keycloak health checks
[keycloak]
    # Keycloak response time
    response_time:
        enabled = yes
        update every = 1
        warn threshold = 1000
        crit threshold = 5000
        
    # Keycloak error rate
    error_rate:
        enabled = yes
        update every = 1
        warn threshold = 5
        crit threshold = 10
        
    # Keycloak throughput
    throughput:
        enabled = yes
        update every = 1
        warn threshold = 100
        crit threshold = 500

# OPA health checks
[opa]
    # OPA response time
    response_time:
        enabled = yes
        update every = 1
        warn threshold = 1000
        crit threshold = 5000
        
    # OPA error rate
    error_rate:
        enabled = yes
        update every = 1
        warn threshold = 5
        crit threshold = 10
        
    # OPA throughput
    throughput:
        enabled = yes
        update every = 1
        warn threshold = 100
        crit threshold = 500

# Prometheus health checks
[prometheus]
    # Prometheus response time
    response_time:
        enabled = yes
        update every = 1
        warn threshold = 1000
        crit threshold = 5000
        
    # Prometheus error rate
    error_rate:
        enabled = yes
        update every = 1
        warn threshold = 5
        crit threshold = 10
        
    # Prometheus throughput
    throughput:
        enabled = yes
        update every = 1
        warn threshold = 100
        crit threshold = 500

# Grafana health checks
[grafana]
    # Grafana response time
    response_time:
        enabled = yes
        update every = 1
        warn threshold = 1000
        crit threshold = 5000
        
    # Grafana error rate
    error_rate:
        enabled = yes
        update every = 1
        warn threshold = 5
        crit threshold = 10
        
    # Grafana throughput
    throughput:
        enabled = yes
        update every = 1
        warn threshold = 100
        crit threshold = 500

# Jaeger health checks
[jaeger]
    # Jaeger response time
    response_time:
        enabled = yes
        update every = 1
        warn threshold = 1000
        crit threshold = 5000
        
    # Jaeger error rate
    error_rate:
        enabled = yes
        update every = 1
        warn threshold = 5
        crit threshold = 10
        
    # Jaeger throughput
    throughput:
        enabled = yes
        update every = 1
        warn threshold = 100
        crit threshold = 500

# AlertManager health checks
[alertmanager]
    # AlertManager response time
    response_time:
        enabled = yes
        update every = 1
        warn threshold = 1000
        crit threshold = 5000
        
    # AlertManager error rate
    error_rate:
        enabled = yes
        update every = 1
        warn threshold = 5
        crit threshold = 10
        
    # AlertManager throughput
    throughput:
        enabled = yes
        update every = 1
        warn threshold = 100
        crit threshold = 500
